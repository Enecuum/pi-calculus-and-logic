
(v монеткаПодделка5)

| инициализироватьМонеты()
  . (v монетка1)
    (v монетка2)
    (v монетка5)
    (v монетка10)
    (v _*)
    ( ()

      | _счётчик<55440>

      | _уменьшитьСчётчик()
        . ( _счётчик(число) | серверВычитания(вычитание) )
        . ( вычитание<число> . вычитание<1> | вычитание(новоеЧисло) . _счётчик<новоеЧисло> )

      | ! сколькоНаСчётчике(канал)
          . _счётчик(число) . ( _счётчик<число> | ! канал<число> )

      | ! уменьшитьСчётчик<> | _токены<_токен>

      | халявныеМонеты(канал)
        . ( серверВычитания(вычитание) | (v счётчик) счётчик<220> )
        . (   ! счётчик(число) . ( вычитание<число> . вычитание<1>  | вычитание(новоеЧисло) . счётчик<новоеЧисло> . канал<монетка1>  )
            | ! счётчик(число) . ( вычитание<число> . вычитание<2>  | вычитание(новоеЧисло) . счётчик<новоеЧисло> . канал<монетка2>  )
            | ! счётчик(число) . ( вычитание<число> . вычитание<5>  | вычитание(новоеЧисло) . счётчик<новоеЧисло> . канал<монетка5>  )
            | ! счётчик(число) . ( вычитание<число> . вычитание<10> | вычитание(новоеЧисло) . счётчик<новоеЧисло> . канал<монетка10> )
          )

      | ! проверитьМонетку(монетка)
          . (v тестовыйКанал)
            (v принятьТест)
            (   ! монетка1  (канал) . канал<> . принятьТест()
              | ! монетка2  (канал) . канал<> . принятьТест()
              | ! монетка5  (канал) . канал<> . принятьТест()
              | ! монетка10 (канал) . канал<> . принятьТест()
              | принятьТест<>
              | тестовыйКанал()
              | монетка<тестовыйКанал>
            )

      | ! серверОценки(канал)
          . ( канал(монетка) | (v оценочныйКанал) (v принятьОценку) )
          . (   ! монетка1  (канал) . канал<> . ( ! канал<1>  ) . принятьОценку()
              | ! монетка2  (канал) . канал<> . ( ! канал<2>  ) . принятьОценку()
              | ! монетка5  (канал) . канал<> . ( ! канал<5>  ) . принятьОценку()
              | ! монетка10 (канал) . канал<> . ( ! канал<10> ) . принятьОценку()
              | оценочныйКанал()
              | принятьОценку<>
              | монетка<оценочныйКанал>
            )
    )


слот (монетка)
 . проверитьМонетку<монетка>
 . (@ каналА)
   серверОценки<каналА>
   . каналА<монетка>
   . каналА(стоимость)


| тестБиндинга(модуль)
  . (@ биндинг)
    (   ( a(тест01) . биндинг<@> )
      | ( b(тест02) . биндинг<@> )
      | ( c(тест03) . биндинг<@> )
    )
    . тест01<"строка">
    . модуль<биндинг>
    . ( биндинг(@) . тест02<"строка"> | тест03<"строка"> )

| тестМодуля()
  . (@ модуль)
    ( тестБиндинга<модуль> | модуль(биндинг) )
    . биндинг(@)
    . тест01<"строка">

